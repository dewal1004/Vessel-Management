OBJECT Modification "Fixed Asset"(Table 5600)
{
  OBJECT-PROPERTIES
  {
    Date=20021020D;
    Time=120000T;
    Version List=NAVW114.18;
  }
  PROPERTIES
  {
    Target="Fixed Asset"(Table 5600);
  }
  CHANGES
  {
    { PropertyModification;
                         Target=DropDown(FieldGroup 1);
                         Property=Fields;
                         OriginalValue="No.",Description,"FA Class Code";
                         ModifiedValue="No.",Description,"FA Class Code","Serial No." }
    { CodeModification  ;OriginalCode=BEGIN
                                        if "No." <> xRec."No." then begin
                                          FASetup.Get;
                                          NoSeriesMgt.TestManual(FASetup."Fixed Asset Nos.");
                                          "No. Series" := '';
                                        end;
                                      END;

                         ModifiedCode=BEGIN
                                         if "No." <> xRec."No." then begin
                                        #2..4
                                         end;
                                      END;

                         Target="No."(Field 1).OnValidate }
    { CodeModification  ;OriginalCode=BEGIN
                                        if "FA Subclass Code" = '' then begin
                                          Validate("FA Posting Group",'');
                                          exit;
                                        #4..11

                                        if "FA Posting Group" = '' then
                                          Validate("FA Posting Group",FASubclass."Default FA Posting Group");
                                      END;

                         ModifiedCode=BEGIN

                                        //AAA - Nov 2001
                                         if "FA Subclass Code"='VESSEL' then "Location Code":="No.";
                                         if (xRec."FA Subclass Code"='VESSEL') and ("FA Subclass Code"<>'VESSEL') then "Location Code":='';
                                        #1..14
                                      END;

                         Target="FA Subclass Code"(Field 6).OnValidate }
    { CodeModification  ;OriginalCode=BEGIN
                                        ValidateShortcutDimCode(1,"Global Dimension 1 Code");
                                      END;

                         ModifiedCode=BEGIN
                                        //ValidateShortcutDimCode(1,"Global Dimension 1 Code");
                                      END;

                         Target="Global Dimension 1 Code"(Field 7).OnValidate }
    { CodeModification  ;OriginalCode=BEGIN
                                        ValidateShortcutDimCode(2,"Global Dimension 2 Code");
                                      END;

                         ModifiedCode=BEGIN
                                        // ValidateShortcutDimCode(2,"Global Dimension 2 Code");
                                        // MODIFY;
                                      END;

                         Target="Global Dimension 2 Code"(Field 8).OnValidate }
    { PropertyInsertion ;Target="Global Dimension 2 Code"(Field 8);
                         Property=InitValue;
                         ModifiedValue=ATLANTIC }
    { PropertyInsertion ;Target="Global Dimension 2 Code"(Field 8);
                         Property=NotBlank;
                         ModifiedValue=true }
    { CodeModification  ;OriginalCode=BEGIN
                                        FAMoveEntries.ChangeBudget(Rec);
                                      END;

                         ModifiedCode=BEGIN
                                        //FAMoveEntries.ChangeBudget(Rec);
                                      END;

                         Target="Budgeted Asset"(Field 14).OnValidate }
    { PropertyInsertion ;Target="Maintenance Vendor No."(Field 23);
                         Property=Description;
                         ModifiedValue=V }
    { Insertion         ;InsertAfter=Image(Field 140);
                         ChangedElements=FieldCollection
                         {
                           { 50300;  ;Voyage No.          ;Integer       ;FieldClass=FlowField;
                                                                          CalcFormula=Count(Job WHERE (Vessel=FIELD("No."),
                                                                                                       "Starting Date"=FIELD("FA Voyage Date Filter"))) }
                           { 50301;  ;FA Voyage Date Filter;Date         ;FieldClass=FlowFilter }
                           { 50320;  ;Overhauling         ;Date           }
                           { 50321;  ;Dry Dock            ;Date           }
                           { 50322;  ;Derating Certificate;Date           }
                           { 50323;  ;Pilotage Licence    ;Date           }
                           { 50324;  ;Fumigation          ;Date           }
                           { 50325;  ;Storage License     ;Date           }
                           { 50326;  ;Life Rafts          ;Date           }
                           { 50327;  ;Extinguishers       ;Date           }
                           { 50328;  ;Fishing License     ;Date           }
                           { 50329;  ;Survey Certificate  ;Date           }
                           { 50427;  ;Maintenance         ;Decimal       ;FieldClass=FlowField;
                                                                          CalcFormula=Sum("Maintenance Ledger Entry".Amount WHERE ("FA No."=FIELD("No."),
                                                                                                                                   "FA Posting Date"=FIELD("FA Posting Date Filter"),
                                                                                                                                   "Depreciation Book Code"=CONST('COMPANY')));
                                                                          CaptionML=ENU=Maintenance;
                                                                          Editable=false;
                                                                          AutoFormatType=1 }
                           { 50428;  ;Maintenance Amt     ;Decimal       ;Description=Last Reported Maintenance Amount }
                         }
                          }
    { Insertion         ;InsertAfter=Description(Key);
                         ChangedElements=KeyCollection
                         {
                           {    ;"Maintenance Amt"                        }
                           {    ;"Serial No."                             }
                         }
                          }
    { CodeModification  ;OriginalCode=BEGIN
                                        if "No." = '' then begin
                                          FASetup.Get;
                                          FASetup.TestField("Fixed Asset Nos.");
                                          NoSeriesMgt.InitSeries(FASetup."Fixed Asset Nos.",xRec."No. Series",0D,"No.","No. Series");
                                        end;

                                        "Main Asset/Component" := "Main Asset/Component"::" ";
                                        "Component of Main Asset" := '';

                                        DimMgt.UpdateDefaultDim(
                                          DATABASE::"Fixed Asset","No.",
                                          "Global Dimension 1 Code","Global Dimension 2 Code");
                                      END;

                         ModifiedCode=BEGIN
                                         if "No." = '' then begin
                                        #2..4
                                         end;

                                         "Main Asset/Component" := "Main Asset/Component"::" ";
                                         "Component of Main Asset" := '';

                                         "Global Dimension 2 Code":='ATLANTIC';     //AAA - Oct 2002
                                         DimMgt.UpdateDefaultDim(
                                          DATABASE::"Fixed Asset","No.",
                                          "Global Dimension 1 Code","Global Dimension 2 Code");
                                      END;

                         Target=OnInsert }
    { CodeModification  ;OriginalCode=BEGIN
                                        "Last Date Modified" := Today;
                                      END;

                         ModifiedCode=BEGIN
                                         "Last Date Modified" := Today;
                                      END;

                         Target=OnModify }
    { CodeModification  ;OriginalCode=BEGIN
                                        with FA do begin
                                          FA := Rec;
                                          FASetup.Get;
                                          FASetup.TestField("Fixed Asset Nos.");
                                          if NoSeriesMgt.SelectSeries(FASetup."Fixed Asset Nos.",OldFA."No. Series","No. Series") then begin
                                            NoSeriesMgt.SetSeries("No.");
                                            Rec := FA;
                                            exit(true);
                                          end;
                                        end;
                                      END;

                         ModifiedCode=BEGIN
                                        //WITH FA DO BEGIN
                                        //  FA := Rec;
                                        //  FASetup.GET;
                                        //  FASetup.TESTFIELD("Fixed Asset Nos.");
                                        //  IF NoSeriesMgt.SelectSeries(FASetup."Fixed Asset Nos.",OldFA."No. Series","No. Series") THEN BEGIN
                                        //    NoSeriesMgt.SetSeries("No.");
                                        //    Rec := FA;
                                        //    EXIT(TRUE);
                                        //  END;
                                        // END;
                                      END;

                         Target=AssistEdit(PROCEDURE 2) }
  }
  CODE
  {

    BEGIN
    END.
  }
}

